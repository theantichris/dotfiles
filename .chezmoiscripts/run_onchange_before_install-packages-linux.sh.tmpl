{{- if and (eq .chezmoi.os "linux") (eq .chezmoi.osRelease.id "cachyos") -}}
#!/bin/bash

# pacman packages

sudo pacman -Syu

sudo pacman -S --needed brightnessctl hypridle hyprlock hyprlauncher hyprpaper hyprpolkitagent hyprpwcenter hyprshot hyprsunset xdg-desktop-portal-hyprland

sudo pacman -S --needed aerc
sudo pacman -S --needed appmenu-gtk-module libdbusmenu-glib
sudo pacman -S --needed bitwarden bitwarden-cli
sudo pacman -S --needed blueman
sudo pacman -S --needed breeze breeze-gtk breeze-icons
sudo pacman -S --needed chawan
sudo pacman -S --needed cmatrix
sudo pacman -S --needed crawl-ncurses
sudo pacman -S --needed git-delta
sudo pacman -S --needed doctl
sudo pacman -S --needed entr
sudo pacman -S --needed eza
sudo pacman -S --needed fzf
sudo pacman -S --needed gemini-cli
sudo pacman -S --needed github-cli
sudo pacman -S --needed glow
sudo pacman -S --needed go golangci-lint go-tools gopls
sudo pacman -S --needed gurk
sudo pacman -S --needed helix bash-language-server harper lua-language-server marksman taplo-cli vscode-json-languageserver yaml-language-server
sudo pacman -S --needed httpie
sudo pacman -S --needed hugo
sudo pacman -S --needed jupyterlab
sudo pacman -S --needed khal
sudo pacman -S --needed lazygit
sudo pacman -S --needed markdownlint-cli2 pre-commit
sudo pacman -S --needed mako
sudo pacman -S --needed network-manager-applet
sudo pacman -S --needed npm
sudo pacman -S --needed nvtop
sudo pacman -S --needed ollama-cuda
sudo pacman -S --needed pass
sudo pacman -S --needed pipewire wireplumber
sudo pacman -S --needed pwvucontrol
sudo pacman -S --needed python-pillow python-term-image python-urwidgets
sudo pacman -S --needed qt5-wayland qt6-wayland
sudo pacman -S --needed rofi
sudo pacman -S --needed signal-desktop
sudo pacman -S --needed speedtest-cli
sudo pacman -S --needed superfile
sudo pacman -S --needed swayimg
sudo pacman -S --needed tailscale
sudo pacman -S --needed toilet
sudo pacman -S --needed toot
sudo pacman -S --needed ttf-hack-nerd
sudo pacman -S --needed uv
sudo pacman -S --needed vhs
sudo pacman -S --needed vdirsyncer python-aiohttp-oauthlib
sudo pacman -S --needed vk-hdr-layer-kwin6-git
sudo pacman -S --needed waybar
sudo pacman -S --needed wlogout

# paru packages

paru -Syu

paru -S --needed adom-noteye
paru -S --needed ascii-image-converter
paru -S --needed crush
paru -S --needed google-chrome
paru -S --needed gotestsum
paru -S --needed hyprqt6engine
paru -S --needed json-log-viewer
paru -S --needed nb
paru -S --needed nom-bin
paru -S --needed sddm-astronaut-theme
paru -S --needed slack-desktop-wayland
paru -S --needed squiid
paru -S --needed tray-tui
paru -S --needed tuios-bin
paru -S --needed wezterm
paru -S --needed xdg-terminal-exec
paru -S --needed zoom

# go packages

go install github.com/Gelio/go-global-update@latest
go install github.com/go-delve/delve/cmd/dlv@latest
go install github.com/goreleaser/goreleaser/v2@latest
go install github.com/orlangure/gocovsh@latest
go install github.com/nametake/golangci-lint-langserver@latest
go install golang.org/x/tools/cmd/goimports@latest

# npm packages

if command -v npm &> /dev/null; then
  npm config set prefix ~/.local

  if ! npm list -g vscode-langservers-extracted; then
    npm i -g vscode-langservers-extracted
    npm i -g pnpm
  fi
fi

# rust packages

sudo pacman -S --needed rustup
rustup default stable
cargo install cargo-update
cargo install outside

# uv packages

if command -v uv &> /dev/null; then
  if ! uv tool list | grep -q "posting"; then
    uv tool install posting
  fi
fi

# gh extensions

gh extension install dlvhdr/gh-dash

# Wezterm terminfo
if ! infocmp wezterm &>/dev/null; then
  tempfile=$(mktemp)
  curl -o $tempfile https://raw.githubusercontent.com/wez/wezterm/main/termwiz/data/wezterm.terminfo
  tic -x -o ~/.terminfo $tempfile
  rm $tempfile
fi

# Start services

sudo systemctl enable --now ollama
sudo systemctl enable --now sshd
sudo systemctl enable --now tailscaled

systemctl --user daemon-reload
systemctl --user enable --now hypridle.service
systemctl --user enable --now hyprpolkitagent.service
systemctl --user enable --now vdirsyncer.timer

# tldr

tldr --update

{{- end }}
